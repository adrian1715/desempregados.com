<%- layout("../layouts/boilerplate") %>

<!-- modal content -->
<div
  id="modal"
  class="modal"
  style="display: <%= showModal ? 'block' : 'none' %>"
>
  <div class="modal-content">
    <span id="close-modal-btn" class="close">&times;</span>
    <h2 class="mb-4">Adicionar nova carreira</h2>
    <form
      action="/api/careers"
      method="POST"
      class="needs-validation"
      novalidate
    >
      <!-- do the same bootstrap validation for all the other forms (follow the example here) -->
      <div class="input-group has-validation">
        <input
          id="career-input"
          type="text"
          name="name"
          placeholder="Nome"
          class="form-control col-12 col-sm-auto"
          required
        />
        <button
          id="submit-career-btn"
          type="submit"
          class="btn btn-success float-end col-12 col-sm-auto"
        >
          <i class="bi bi-check-lg me-1"></i>Salvar
        </button>
        <div class="invalid-feedback">Insira um nove de carreira.</div>
      </div>
    </form>
  </div>
</div>

<main class="container py-5">
  <%- include("../../partials/flash") %>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="d-inline-block">Carreiras</h1>
    <button id="open-modal-btn" class="btn btn-success ms-2">
      <i class="bi bi-patch-plus me-2"></i>Nova carreira*
    </button>
  </div>
  <div class="container row mb-3">
    <% for (let i = 0; i < careers.length; i++) { if(careers[i] !== 'index') {
    %>
    <div class="col-md-6 col-lg-4 career-card mb-3">
      <div class="card card-body">
        <h2 class="card-title"><%= careers[i].name %></h2>
        <% if(careers[i].pages.length > 0) { %>
        <img
          src="<%= careers[i].pages[0]?.header.image.url %>"
          alt="career card image"
          style="height: 12em"
          class="card-img"
        />
        <% } %>
        <p class="card-text"><%= careers[i].pages[0]?.header.subtitle %></p>
        <div>
          <a
            href="<%= careers[i].pages.length > 1 ? `/carreiras/${formatCareerName(careers[i].name)}/${formatCareerName(careers[i].pages[0]._id)}` : `/carreiras/${formatCareerName(careers[i].name)}` %>"
            class="btn btn-sm btn-primary"
            >Ver mais</a
          >
          <% if (careers[i].pages.length > 1) { %>
          <a
            href="/carreiras/<%= formatCareerName(careers[i].name) %>"
            class="btn btn-sm btn-secondary"
            >Todas as pÃ¡ginas</a
          >
          <% } %>
        </div>
      </div>
    </div>

    <% } } %>
  </div>
</main>
